# Pico 雷达演示项目

## 硬件信息

- 开发板：Raspberry Pi Pico
- 舵机：SG90
- TFT 屏幕：ST7735 1.8寸 128×160
- 超声波测距模块：HC-SR04

## 项目简介

本项目基于树莓派 Pico（或兼容 MicroPython 的开发板），结合超声波测距模块、舵机和 1.8 寸 ST7735 彩屏，实现了一个“雷达扫描”效果的演示系统。超声波模块随舵机旋转扫描，测得的距离数据实时以雷达扇形图方式显示在 TFT 屏幕上，模拟真实雷达的扫描与回波效果。

## 主要功能

- 控制舵机带动超声波模块在 30°~150° 范围内往返扫描
- 实时采集距离数据，显示在 TFT 屏幕的雷达扇形图上
- 障碍物以红点形式显示，自动消隐
- 雷达背景带有刻度和圆弧，视觉效果美观
- 距离数据通过串口输出，便于调试

## 目录结构

```text
pico/
  ├── main.py              # 主程序，负责舵机、超声波测距和主循环
  ├── radar_display.py     # 雷达图形显示相关函数
  └── st7735.py            # ST7735 TFT 屏幕驱动
```

## 硬件连接

| 模块         | Pico引脚 | 说明         |
| ------------ | -------- | ------------ |
| ST7735 TFT   | SCK-GP10 | SPI时钟      |
|              | MOSI-GP11| SPI数据      |
|              | DC-GP13  | 数据/命令    |
|              | RESET-GP12| 复位        |
|              | CS-GP14  | 片选         |
| 超声波模块   | TRIG-GP2 | 触发         |
|              | ECHO-GP3 | 回响         |
| 舵机         | PWM-GP15 | 舵机信号     |

其余电源、地线按模块要求连接。

## 软件依赖

- MicroPython 固件
- `machine`、`time`、`math`（MicroPython 内置）
- 项目自带 `st7735.py` 驱动，无需额外安装

## 使用方法

1. 烧录 MicroPython 固件到开发板
2. 上传本项目所有文件到开发板（如使用 Thonny、mpremote、ampy 等工具）
3. 按上表说明连接硬件
4. 运行 `main.py`，即可看到 TFT 屏幕上出现雷达扫描动画，障碍物以红点显示，距离数据通过串口输出

## 主要代码说明

- `main.py`  
  初始化舵机、超声波模块和屏幕，控制舵机角度，循环测距，调用 `radar_display.draw_scan(angle, distance)` 实时刷新雷达图。
- `radar_display.py`  
  负责绘制雷达背景、扫描线、障碍物点、自动消隐等，提供 `draw_radar_bg()`、`draw_scan(angle, distance)` 等接口。
- `st7735.py`  
  ST7735 屏幕底层驱动，支持像素、线、圆、文本等基本绘图操作。

## 效果演示

- 屏幕显示为半圆雷达扇形，绿色为刻度和圆弧
- 黄色扫描线随舵机摆动
- 检测到障碍物时，在对应角度和距离处显示红点，1秒后自动消失

## 串口输出

每次测量会通过串口输出一行数据，格式为：

```
角度,距离
如： 90,12.3
```

距离超出最大测量范围（30cm）时，距离输出为 0.0。

## 注意事项

- 若屏幕颜色异常，请尝试将 `radar_display.py` 中 `tft.initr()` 改为 `tft.initb()` 或 `tft.initg()`，以适配不同批次的 ST7735 屏幕
- 舵机和超声波模块建议单独供电，避免电压不稳导致测量异常
- 若需调整最大测距范围，可修改 `MAX_DIST_CM` 常量

## 致谢

- ST7735 驱动参考自开源项目
- 雷达显示算法原创，欢迎改进和反馈 
